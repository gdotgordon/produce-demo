# .travis.yml
language: go

services:
  - docker

go:
  - "1.12.x"

script:
  - ./.travis.gofmt.sh
  - go vet ./...
  - go test -v -race $(go list ./... | grep -v vendor)
  - export TAG="v0.1"
  - export REPO=$DOCKER_USERNAME/produce-demo
  - docker build -t $REPO:$TAG -t $REPO:latest -f Dockerfile .

deploy:
  provider: script
  script: bash docker_push
  on:
    branch: master
